services:
  crawler:
    image: bootdotdev/synergychat-crawler
    environment:
      - CRAWLER_PORT=8080
      - CRAWLER_KEYWORDS=love,hate,joy,sadness,anger,disgust,fear,surprise
      - CRAWLER_DB_PATH=/var/lib/synergychat/crawler/db
    volumes:
      - ./crawler-db:/var/lib/synergychat/crawler/db
    networks:
      - synergychat

  api:
    image: bootdotdev/synergychat-api
    environment:
      - API_PORT=8080
      - CRAWLER_BASE_URL=http://crawler:8080
    networks:
      - synergychat
    depends_on:
      - crawler

  web:
    image: bootdotdev/synergychat-web
    environment:
      - WEB_PORT=8080
      - API_URL=/api
    networks:
      - synergychat
    depends_on:
      - api

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./nginx/certs:/etc/nginx/certs:ro
    networks:
      - synergychat
    depends_on:
      - web
      - api


networks:
  synergychat:
    driver: bridge